MDScreenManager:
    InitialScreen:
        id: initial_id
    LoginScreen:
        id: login_id
    SignUpScreen:
        id: signup_id
    ForgetPassWordScreen:
        id: password_id
    AboutScreen:
        id: about_id
    TimeLineScreen:
        id: timeline_id
    NewPostScreen:
        id: newpost_id
    WelcomeScreen:
        id: welcome_id

<FillButtonBase@MDFillRoundFlatButton>:
    font_style: "Button"
    md_bg_color: "#422315"

<TextFieldBase@MDTextField>
    size_hint: 1, None
    height: "30dp"
    font_size: "18dp"
    text_color_normal: "gray"
    text_color_focus: "white"
    multiline: False
    line_color_normal: "black"
    line_color_focus: "maroon"
    hint_text_color_normal: "black"
    hint_text_color_focus: "maroon"
    cursor_width: "2sp"
    icon_left_color_normal: "gray"
    icon_left_color_focus: "black"


<InitialScreen@MDScreen>:
    name: "initial"
    md_bg_color: "#bd9f83"

    MDHeroFrom:
        id: hero_from
        tag: "hero"
        size_hint: None, None
        size: "200dp", "200dp"
        pos_hint: {"center_x": .5, "center_y": .66}
        FitImage:
            source: "images/logo.png"
            size_hint: None, None
            size: hero_from.size

    MDFloatLayout:
        FillButtonBase:
            text: "COMEÇAR AGORA"
            pos_hint: {"center_x": .5, "center_y": .4}
            size_hint: .6, .09
            on_release:
                app.root.current_heroes = ["hero"]
                app.root.current = "login"
                app.root.transition.direction = "left"

        FillButtonBase:
            text:"SOBRE"
            pos_hint: {"center_x": .5, "center_y": .28}
            size_hint: .6, .09
            on_release:
                app.root.current_heroes = ["hero"]
                app.root.current = "about"
                app.root.transition.direction = "left"

<LoginScreen@MDScreen>:
    name: "login"
    hero_to: hero_to_login
    md_bg_color: "#bd9f83"

    MDHeroTo:
        id: hero_to_login
        tag: "hero"
        size_hint: None, None
        size: "220dp", "220dp"
        pos_hint: {"center_x": .5, "center_y": .85}

    MDFloatLayout:
        size_hint: 1, 1
        MDFloatLayout:
            pos_hint: {"center_x": .5, "center_y": .55}
            size_hint: .78, 1

            TextFieldBase:
                id: email_login
                pos_hint: {"center_x": .5, "center_y": .56}
                icon_left: "email"
                hint_text: "Email:"

            TextFieldBase:
                id: password_login
                pos_hint: {"center_x": .5, "center_y": .44}
                hint_text: "Senha:"
                icon_left: "key-variant"
                password: True

            MDIconButton:
                icon: "eye-off"
                pos_hint: {"center_x": 0.95, "center_y": .44}
                pos: password_login.width - self.width + dp(8), 0
                theme_text_color: "Hint"

                on_release:
                    self.icon = "eye" if self.icon == "eye-off" else "eye-off"
                    password_login.password = False if password_login.password == True else True

            MDTextButton:
                id: redefine_password
                text: "Redefinir senha"
                custom_color: "white"
                pos_hint: {"center_x": .8, "center_y": .33}
                on_release:
                    app.root.current = "recpaswrd"
                    app.root.transition.direction = "left"

        MDLabel: 
            id: lbl
            text: " "
            bold: True
            pos_hint: {"center_x": .71, "center_y": .69}

        FillButtonBase:
            text: "Entrar"
            size_hint: .55, .07
            pos_hint: {"center_x": .5, "center_y": .25}
            on_release:
                if root.verify_data(email_login.text, password_login.text) == True: app.root.current = "welcome" 
                elif root.verify_data(email_login.text, password_login.text) == False: lbl.text = 'LOGIN INCORRETO'
                app.root.current_heroes = []
                
        FillButtonBase:
            text: "Cadastrar-se"
            size_hint: .55, .07
            pos_hint: {"center_x": .5, "center_y": .15}
            on_release:
                app.root.current_heroes = []
                app.root.current = "signup"
                app.root.transition.direction = "left"

    MDIconButton:
        icon: "chevron-triple-left"
        icon_size: "43sp"
        theme_icon_color: "Custom"
        icon_color: "#422315"
        pos_hint: {"center_x": .099, "center_y": .06} 
        on_release:
            app.root.current_heroes = ["hero"]
            app.root.current = "initial"
            app.root.transition.direction = "right"

<SignUpScreen@MDScreen>:
    name: "signup"
    md_bg_color: "#bd9f83"
    
    MDFloatLayout:
        size_hint: 1, 1

        MDFloatLayout:
            pos_hint: {"center_x": .5, "center_y": .55}
            size_hint: .78, 1

            TextFieldBase:
                id: name_signup
                pos_hint: {"center_x": .5, "center_y": .56}
                icon_left: "account"
                hint_text: "Nome:"

            TextFieldBase:
                id: email_signup
                pos_hint: {"center_x": .5, "center_y": .44}
                hint_text: "Email:"
                icon_left: "email"

            TextFieldBase:
                id: password_signup
                pos_hint: {"center_x": .5, "center_y": .32}
                hint_text: "Senha:"
                icon_left: "key-variant"
                password: True

            MDIconButton:
                icon: "eye-off"
                pos_hint: {"center_x": 0.95, "center_y": .32}
                pos: password_signup.width - self.width + dp(8), 0
                theme_text_color: "Hint"

                on_release:
                    self.icon = "eye" if self.icon == "eye-off" else "eye-off"
                    password_signup.password = False if password_signup.password == True else True
                    
        MDLabel: 
            id: lbc
            text: " "
            bold: True
            pos_hint: {"center_x": .71, "center_y": .69}

        FillButtonBase:
            text: "Cadastrar"
            size_hint: .6, .09
            pos_hint: {"center_x": .5, "center_y": .2}
            on_release:
                if root.send_data(name_signup.text, email_signup.text, password_signup.text) == "emailcorreto": app.root.current = "welcome"
                elif root.send_data(name_signup.text, email_signup.text, password_signup.text) == "emailinva": lbc.text = "Cadastre o email corretamente"
                
    MDIconButton:
        icon: "chevron-triple-left"
        icon_size: "43sp"
        theme_icon_color: "Custom"
        icon_color: "#422315"
        pos_hint: {"center_x": .099, "center_y": .06} 
        on_release:
            app.root.current = "login"
            app.root.transition.direction = "right"

<ForgetPassWordScreen@MDScreen>:
    name: "recpaswrd"
    md_bg_color: "#bd9f83"
    
    MDFloatLayout:
        size_hint: 1, 1

        MDFloatLayout:
            pos_hint: {"center_x": .5, "center_y": .55}
            size_hint: .78, 1


            TextFieldBase:
                id: email_rec
                pos_hint: {"center_x": .5, "center_y": .56}
                icon_left: "email"
                hint_text: "Email:"

            TextFieldBase:
                id: password_rec
                pos_hint: {"center_x": .5, "center_y": .44}
                hint_text: "Senha:"
                icon_left: "key-variant"
                password: True

            MDIconButton:
                icon: "eye-off"
                pos_hint: {"center_x": 0.95, "center_y": .44}
                pos: password_rec.width - self.width + dp(8), 0
                theme_text_color: "Hint"

                on_release:
                    self.icon = "eye" if self.icon == "eye-off" else "eye-off"
                    password_rec.password = False if password_rec.password == True else True
                    
        MDLabel: 
            id: lbrec
            text: " "
            bold: True
            pos_hint: {"center_x": .61, "center_y": .69}

        FillButtonBase:
            text: "Recuperar"
            size_hint: .6, .09
            pos_hint: {"center_x": .5, "center_y": .2}
            on_release:
                root.rst_pswrd(email_rec.text, password_rec.text)
                
    MDIconButton:
        icon: "chevron-triple-left"
        icon_size: "43sp"
        theme_icon_color: "Custom"
        icon_color: "#422315"
        pos_hint: {"center_x": .099, "center_y": .06} 
        on_release:
            app.root.current = "login"
            app.root.transition.direction = "right"

<AboutScreen@MDScreen>:
    name: "about"
    hero_to: hero_to_about
    md_bg_color: "#bd9f83"

    MDHeroTo:
        id: hero_to_about
        tag: "hero"
        size_hint: None, None
        size: "220dp", "220dp"
        pos_hint: {"center_x": .5, "center_y": .85}

    MDFloatLayout:
        size_hint: 1, 1

        MDFloatLayout:
            pos_hint: {"center_x": .5, "center_y": .5}
            size_hint: .85, .65 
            padding: .75, .75, .75, .75

            MDLabel:
                text: "Sobre nós:"
                pos_hint: {"center_x": .52, "center_y": .75}
                font_style: "Button"
                theme_text_color: "Custom"
                text_color: 66/255, 35/255, 21/255, 1

            MDLabel:
                text: "SOBRE SOBRE SOBRE SOBRE\nSOBRE SOBRE SOBRE SOBRE\nSOBRE SOBRE SOBRE SOBRE\nSOBRE SOBRE SOBRE SOBRE\n"
                pos_hint: {"center_x": .52, "center_y": .60}
                theme_text_color: "Custom"
                text_color: 66/255, 35/255, 21/255, 1

    MDIconButton:
        icon: "chevron-triple-left"
        icon_size: "43sp"
        theme_icon_color: "Custom"
        icon_color: "#422315"
        pos_hint: {"center_x": .099, "center_y": .06} 
        on_release:
            app.root.current_heroes = ["hero"]
            app.root.current = "initial"
            app.root.transition.direction = "right"

<TimeLineScreen@MDScreen>:
    name: "timeline"

    MDNavigationLayout:
        MDScreenManager:
            MDScreen:
                MDBoxLayout:
                    md_bg_color: "#bd9f83"
                    orientation: "vertical"
                    spacing: 10

                    MDTopAppBar:
                        md_bg_color: "#422315"
                        left_action_items: [["menu", lambda x: nav_drawer.set_state("open")]]

                    MDScrollView:
                        do_scroll_x: False
                        do_scroll_y: True

                        MDBoxLayout:
                            id: box_timeline
                            orientation: "vertical"
                            size_hint_y: None
                            height: self.minimum_height
                            spacing: 10

                MDFloatingActionButton:
                    type: "standard"
                    md_bg_color: "#422315"
                    icon: "plus"
                    icon_color: 1,1,1,1
                    pos_hint:{"center_x": .9, "center_y": .07}
                    on_release:
                        app.root.current = "newpost"
                        app.root.transition.direction = "left"
                        app.root.current_heroes = []
                        
                
                MDFloatingActionButton:
                    type: "standard"
                    md_bg_color: "#422315"
                    icon: "sync"
                    icon_color: 1,1,1,1
                    pos_hint: {"center_x": .1, "center_y": .07 }
                    on_press:
                        root.attTL()

        MDNavigationDrawer:
            id: nav_drawer
            radius: 0, 16, 16, 0

            MDNavigationDrawerMenu:

                MDNavigationDrawerHeader:
                    title: "Header title"
                    title_color: "#4a4939"
                    text: "Header text"
                    spacing: "4dp"
                    padding: "12dp", 0, 0, "56dp"

<NewPostScreen@MDScreen>:
    name: "newpost"
    md_bg_color: "#bd9f83"
    MDFloatLayout:
        size_hint: 1, 1
        MDFloatLayout:
            id: float_newP
            pos_hint: {"center_x": .5, "center_y": .55}
            size_hint: .78, 1 
            MDFloatingActionButton:
                type: "standard"
                md_bg_color: "#422315"
                icon: "chevron-right"
                icon_color: 1,1,1,1
                pos_hint:{"center_x": .9, "center_y": .07}
                on_release:
                    root.new_post(title_id.text, text_id.text, app.root.ids.login_id.ids.email_login.text, app.root.ids.login_id.ids.password_login.text)
                    app.root.current = "timeline"
                    app.root.transition.direction = "right"

<WelcomeScreen@MDScreen>:
    name: "welcome"
    md_bg_color: "#bd9f83"

    MDFloatLayout:
        MDLabel:
            halign: "center"
            text: "oi"

        MDIconButton:
            icon: "chevron"
            on_press:
                root.load_posts()

                